

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Reference &mdash; MNEflow 0.2-beta documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="History" href="changelog.html" />
    <link rel="prev" title="MNEflow" href="intro.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> MNEflow
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">MNEflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#examples">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#references">References</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-mneflow.models">mneflow.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mneflow.data">mneflow.Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mneflow.optimize">mneflow.Optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mneflow.utils">mneflow.utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MNEflow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>API Reference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/mneflow.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-mneflow.models">
<span id="mneflow-models"></span><h2>mneflow.models<a class="headerlink" href="#module-mneflow.models" title="Permalink to this headline">¶</a></h2>
<p>Defines mneflow.models.Model parent class and the implemented models as its
subclasses. Implemented models inherit basic methods from the parent class.</p>
<dl class="class">
<dt id="mneflow.models.Model">
<em class="property">class </em><code class="descclassname">mneflow.models.</code><code class="descname">Model</code><span class="sig-paren">(</span><em>Dataset</em>, <em>Optimizer</em>, <em>specs</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Parent class for all MNEflow models</p>
<p>Provides fast and memory-efficient data handling and simplified API.
Custom models can be built by overriding _build_graph and
set_optimizer methods.</p>
<dl class="method">
<dt id="mneflow.models.Model.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>Dataset</em>, <em>Optimizer</em>, <em>specs</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.Model.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Dataset</strong> (<em>mneflow.Dataset</em>) – Dataset object.</p></li>
<li><p><strong>Optimizer</strong> (<em>mneflow.Optimizer</em>) – Optimizer object.</p></li>
<li><p><strong>specs</strong> (<em>dict</em>) – dictionary of model-specific hyperparameters. Must include at
least model_path - path for saving a trained model. See
subclass definitions for details.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mneflow.models.Model.build">
<code class="descname">build</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.Model.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile a model</p>
</dd></dl>

<dl class="method">
<dt id="mneflow.models.Model.build_graph">
<code class="descname">build_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.Model.build_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Build computational graph using defined placeholder self.X as input</p>
<p>Can be overriden in a sub-class for customized architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>y_pred</strong> – output of the forward pass of the computational graph.
prediction of the target variable</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mneflow.models.Model.evaluate_performance">
<code class="descname">evaluate_performance</code><span class="sig-paren">(</span><em>data_path</em>, <em>batch_size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.Model.evaluate_performance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute performance metric on a TFR dataset specified by path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_path</strong> (<em>str</em><em>, </em><em>list of str</em>) – path to .tfrecords file(s).</p></li>
<li><p><strong>batch_size</strong> (<em>NoneType</em><em>, </em><em>int</em>) – whether to split the dataset into batches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mneflow.models.Model.load">
<code class="descname">load</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.Model.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a pretrained model</p>
<p>To load a specific model the model object should be initialized using
the corresponding metadata and computational graph</p>
</dd></dl>

<dl class="method">
<dt id="mneflow.models.Model.plot_cm">
<code class="descname">plot_cm</code><span class="sig-paren">(</span><em>dataset='validation'</em>, <em>class_names=None</em>, <em>normalize=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.Model.plot_cm" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a confusion matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>str {'training'</em><em>, </em><em>'validation'}</em>) – which dataset to use for plotting confusion matrix</p></li>
<li><p><strong>class_names</strong> (<em>list of str</em><em>, </em><em>optional</em>) – if provided subscribes the classes, otherwise class labels
are used</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – whether to return percentages (if True) or counts (False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mneflow.models.Model.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>n_iter</em>, <em>eval_step=250</em>, <em>min_delta=1e-06</em>, <em>early_stopping=3</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.Model.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_iter</strong> (<em>int</em>) – maximum number of training iterations.</p></li>
<li><p><strong>eval_step</strong> (<em>int</em>) – How often to evaluate model performance during training.</p></li>
<li><p><strong>early_stopping</strong> (<em>int</em>) – Patience parameter for early stopping. Specifies the number of
‘eval_step’s during which validation cost is allowed to rise
before training stops.</p></li>
<li><p><strong>min_delta</strong> (<em>float</em>) – Convergence threshold for validation cost during training.
Defaults to 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mneflow.models.LFCNN">
<em class="property">class </em><code class="descclassname">mneflow.models.</code><code class="descname">LFCNN</code><span class="sig-paren">(</span><em>Dataset</em>, <em>Optimizer</em>, <em>specs</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.LFCNN" title="Permalink to this definition">¶</a></dt>
<dd><p>LF-CNN. Includes basic paramter interpretation options.</p>
<p>For details see [1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_ls</strong> (<em>int</em>) – number of latent components
Defaults to 32</p></li>
<li><p><strong>filter_length</strong> (<em>int</em>) – length of spatio-temporal kernels in the temporal
convolution layer. Defaults to 7</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – stride of the max pooling layer. Defaults to 1</p></li>
<li><p><strong>pooling</strong> (<em>int</em>) – pooling factor of the max pooling layer. Defaults to 2</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1]  I. Zubarev, et al., Adaptive neural network classifier for
decoding MEG signals. Neuroimage. (2019) May 4;197:425-434</p>
<dl class="method">
<dt id="mneflow.models.LFCNN.build_graph">
<code class="descname">build_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.LFCNN.build_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Build computational graph using defined placeholder self.X as input</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>y_pred</strong> – output of the forward pass of the computational graph.
prediction of the target variable</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mneflow.models.LFCNN.compute_patterns">
<code class="descname">compute_patterns</code><span class="sig-paren">(</span><em>megdata=None</em>, <em>output='patterns'</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.LFCNN.compute_patterns" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes spatial patterns from filter weights.</p>
<p>Required for visualization.</p>
</dd></dl>

<dl class="method">
<dt id="mneflow.models.LFCNN.plot_out_weihts">
<code class="descname">plot_out_weihts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.LFCNN.plot_out_weihts" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the weights of the output layer</p>
</dd></dl>

<dl class="method">
<dt id="mneflow.models.LFCNN.plot_patterns">
<code class="descname">plot_patterns</code><span class="sig-paren">(</span><em>sensor_layout='Vectorview-grad'</em>, <em>sorting='l2'</em>, <em>spectra=True</em>, <em>fs=None</em>, <em>scale=False</em>, <em>names=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.LFCNN.plot_patterns" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot informative spatial activations patterns for each class of stimuli</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sensor_layout</strong> (<em>str</em><em> or </em><em>mne.channels.Layout</em>) – sensor layout. See mne.channels.read_layout for details</p></li>
<li><p><strong>sorting</strong> (<em>str</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>spectra</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True will also plot frequency responses of the associated
temporal filters. Defaults to False</p></li>
<li><p><strong>fs</strong> (<em>float</em>) – sampling frequency</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>otional</em>) – If True will min-max scale the output. Defaults to False</p></li>
<li><p><strong>names</strong> (<em>list of str</em><em>, </em><em>optional</em>) – Class names</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Figure</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mneflow.models.VARCNN">
<em class="property">class </em><code class="descclassname">mneflow.models.</code><code class="descname">VARCNN</code><span class="sig-paren">(</span><em>Dataset</em>, <em>Optimizer</em>, <em>specs</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.VARCNN" title="Permalink to this definition">¶</a></dt>
<dd><p>VAR-CNN</p>
<p>For details see [1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_ls</strong> (<em>int</em>) – number of latent components
Defaults to 32</p></li>
<li><p><strong>filter_length</strong> (<em>int</em>) – length of spatio-temporal kernels in the temporal
convolution layer. Defaults to 7</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – stride of the max pooling layer. Defaults to 1</p></li>
<li><p><strong>pooling</strong> (<em>int</em>) – pooling factor of the max pooling layer. Defaults to 2</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1]  I. Zubarev, et al., Adaptive neural network classifier for
decoding MEG signals. Neuroimage. (2019) May 4;197:425-434</p>
<dl class="method">
<dt id="mneflow.models.VARCNN.build_graph">
<code class="descname">build_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.VARCNN.build_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Build computational graph using defined placeholder self.X as input</p>
<p>Can be overriden in a sub-class for customized architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>y_pred</strong> – output of the forward pass of the computational graph.
prediction of the target variable</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mneflow.models.EEGNet">
<em class="property">class </em><code class="descclassname">mneflow.models.</code><code class="descname">EEGNet</code><span class="sig-paren">(</span><em>Dataset</em>, <em>Optimizer</em>, <em>specs</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.EEGNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eegnet_params</strong> (<em>dict</em>) – </p></li>
<li><p><strong>n_ls</strong> (<em>int</em>) – number of (temporal) convolution kernrels in the first layer.
Defaults to 8</p></li>
<li><p><strong>filter_length</strong> (<em>int</em>) – length of temporal filters in the first layer.
Defaults to 32</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – stride of the average polling layers. Defaults to 4.</p></li>
<li><p><strong>pooling</strong> (<em>int</em>) – pooling factor of the average polling layers. Defaults to 4.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1] V.J. Lawhern, et al., EEGNet: A compact convolutional neural network
for EEG-based brain–computer interfaces 10 J. Neural Eng., 15 (5) (2018),
p. 056013</p>
<p>[2]  Original  EEGNet implementation by the authors can be found at
<a class="reference external" href="https://github.com/vlawhern/arl-eegmodels">https://github.com/vlawhern/arl-eegmodels</a></p>
<dl class="method">
<dt id="mneflow.models.EEGNet.build_graph">
<code class="descname">build_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.models.EEGNet.build_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Build computational graph using defined placeholder self.X as input</p>
<p>Can be overriden in a sub-class for customized architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>y_pred</strong> – output of the forward pass of the computational graph.
prediction of the target variable</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mneflow.data">
<span id="mneflow-dataset"></span><h2>mneflow.Dataset<a class="headerlink" href="#module-mneflow.data" title="Permalink to this headline">¶</a></h2>
<p>Defines mneflow.Dataset object</p>
<dl class="class">
<dt id="mneflow.data.Dataset">
<em class="property">class </em><code class="descclassname">mneflow.data.</code><code class="descname">Dataset</code><span class="sig-paren">(</span><em>h_params</em>, <em>train_batch=200</em>, <em>class_subset=None</em>, <em>combine_classes=False</em>, <em>pick_channels=None</em>, <em>decim=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.data.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>TFRecords dataset from TFRecords files using the metadata.</p>
<dl class="method">
<dt id="mneflow.data.Dataset.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>h_params</em>, <em>train_batch=200</em>, <em>class_subset=None</em>, <em>combine_classes=False</em>, <em>pick_channels=None</em>, <em>decim=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.data.Dataset.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize tf.data.TFRdatasets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h_params</strong> (<em>dict</em>) – metadata file, output of mneflow.utils.produce_tfrecords.
See mneflow.utils.produce_tfrecords for details.</p></li>
<li><p><strong>train_batch</strong> (<em>int</em><em>, </em><em>optional</em>) – Training mini-batch size. Deafults to 200</p></li>
<li><p><strong>class_subset</strong> (<em>NoneType</em><em>, </em><em>list of int</em><em>, </em><em>optional</em>) – Pick a subset of classes from the dataset. Note that
class labels produced by mneflow are always defined as
integers in range [0 - n_classes). See
meta[‘orig_classes’] for mapping between
{new_class:old_class}. If None, all classes are used.
Defaults to None.</p></li>
<li><p><strong>combine_classes</strong> (<em>list</em><em>, </em><em>optional</em>) – Not Implemented, optional</p></li>
<li><p><strong>pick_channels</strong> (<em>NoneType</em><em>, </em><em>ndarray of int</em><em>, </em><em>optional</em>) – Indices of a subset of channels to pick for analysis.
If None, all classes are used.  Defaults to None.</p></li>
<li><p><strong>decim</strong> (<em>NoneType</em><em>, </em><em>int</em><em>, </em><em>optional</em>) – Decimation factor. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mneflow.optimize">
<span id="mneflow-optimizer"></span><h2>mneflow.Optimizer<a class="headerlink" href="#module-mneflow.optimize" title="Permalink to this headline">¶</a></h2>
<p>This module specifies Optimizer object</p>
<dl class="class">
<dt id="mneflow.optimize.Optimizer">
<em class="property">class </em><code class="descclassname">mneflow.optimize.</code><code class="descname">Optimizer</code><span class="sig-paren">(</span><em>learn_rate=0.0003</em>, <em>l1_lambda=0</em>, <em>l2_lambda=0</em>, <em>task='classification'</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.optimize.Optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimizer object.</p>
<dl class="method">
<dt id="mneflow.optimize.Optimizer.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>learn_rate=0.0003</em>, <em>l1_lambda=0</em>, <em>l2_lambda=0</em>, <em>task='classification'</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.optimize.Optimizer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>learn_rate</strong> (<em>float</em>) – learning rate</p></li>
<li><p><strong>l1_lambda</strong> (<em>float</em><em>, </em><em>optional</em>) – coefficient for sparse penaly on hte parameter weights</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>{'classification'</em><em>, </em><em>'regression'}</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mneflow.optimize.Optimizer.set_optimizer">
<code class="descname">set_optimizer</code><span class="sig-paren">(</span><em>y_pred</em>, <em>y_true</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.optimize.Optimizer.set_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the optimizer part of the computational graph</p>
<p>This method can be overriden a for custom optimizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> (<em>tf.Tensor</em>) – predictions of the target varible, output of the
computational graph</p></li>
<li><p><strong>y_true</strong> (<em>tf.Tensor</em>) – target_variable, output of dataset.iterator</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>train_step</strong> – training operation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Operation</p>
</dd>
</dl>
<dl class="simple">
<dt>performance<span class="classifier">tf.Tensor</span></dt><dd><p>performance metric</p>
</dd>
<dt>cost<span class="classifier">tf.Tensor</span></dt><dd><p>cost (objective) function output</p>
</dd>
<dt>prediciton<span class="classifier">tf.Tensor</span></dt><dd><p>model output</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mneflow.utils">
<span id="mneflow-utils"></span><h2>mneflow.utils<a class="headerlink" href="#module-mneflow.utils" title="Permalink to this headline">¶</a></h2>
<p>Specifies utility functions.</p>
<dl class="function">
<dt id="mneflow.utils.leave_one_subj_out">
<code class="descclassname">mneflow.utils.</code><code class="descname">leave_one_subj_out</code><span class="sig-paren">(</span><em>meta</em>, <em>optimizer_params</em>, <em>graph_specs</em>, <em>model</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.utils.leave_one_subj_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a leave-one-out cross-validation such that on each fold one
input .tfrecord file is used as a validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meta</strong> (<em>dict</em>) – Dictionary containing metadata for initializing mneflow.Dataset.
Normally meta is anoutput of produce_tfrecords function.</p></li>
<li><p><strong>optimizer_params</strong> (<em>dict</em>) – Dictionary of parameters for initializing mneflow.Opimizer.</p></li>
<li><p><strong>graph_specs</strong> (<em>dict</em>) – Dictionary of model-specific parameters.</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#mneflow.models.Model" title="mneflow.models.Model"><em>mneflow.models.Model</em></a>) – Class of model to be used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results</strong> – List of dictionaries, containg final cost and performance estimates
on each fold of the cross-validation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mneflow.utils.load_meta">
<code class="descclassname">mneflow.utils.</code><code class="descname">load_meta</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.utils.load_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a metadata file
:param fname: path to TFRecord folder
:type fname: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>meta</strong> – metadata file</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mneflow.utils.produce_labels">
<code class="descclassname">mneflow.utils.</code><code class="descname">produce_labels</code><span class="sig-paren">(</span><em>y</em>, <em>return_stats=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.utils.produce_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces labels array from e.g. event (unordered) trigger codes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_epochs</em><em>,</em><em>)</em>) – array of trigger codes.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>inv</strong> (<em>ndarray, shape (n_epochs)</em>) – ordered class labels.</p></li>
<li><p><strong>total_counts</strong> (<em>int</em>)</p></li>
<li><p><strong>class_proportions</strong> (<em>dict</em>) – {new_class: proportion of new_class1 in the dataset}.</p></li>
<li><p><strong>orig_classes</strong> (<em>dict</em>) – {new_class:old_class}.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mneflow.utils.produce_tfrecords">
<code class="descclassname">mneflow.utils.</code><code class="descname">produce_tfrecords</code><span class="sig-paren">(</span><em>inputs</em>, <em>savepath</em>, <em>out_name</em>, <em>overwrite=False</em>, <em>savebatch=1</em>, <em>save_origs=False</em>, <em>val_size=0.2</em>, <em>fs=None</em>, <em>scale=False</em>, <em>scale_interval=None</em>, <em>crop_baseline=True</em>, <em>decimate=False</em>, <em>bp_filter=False</em>, <em>picks=None</em>, <em>combine_events=None</em>, <em>task='classification'</em>, <em>array_keys={'X': 'X'</em>, <em>'y': 'y'}</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.utils.produce_tfrecords" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces TFRecord files from input, applies (optional) preprocessing</p>
<p>Calling this function will covnert the input data into TFRecords format
that is used to effiently store and run Tensorflow models on the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>list</em><em>, </em><em>mne.epochs.Epochs</em><em>, </em><em>str</em>) – list of mne.epochs.Epochs or strings with filenames. If input is a
single string or Epochs object it is firts converted into a list.</p></li>
<li><p><strong>savepath</strong> (<em>str</em>) – a path where the output TFRecord and corresponding metadata
files will be stored.</p></li>
<li><p><strong>out_name</strong> (<em>str</em>) – filename prefix for the output files.</p></li>
<li><p><strong>savebatch</strong> (<em>int</em>) – number of input files per to be stored in the output TFRecord file.
Deafults to 1.</p></li>
<li><p><strong>save_origs</strong> (<em>bool</em><em>, </em><em>optinal</em>) – If True, also saves the whole dataset in original order, e.g. for
leave-one-subject-out cross-validation. Defaults to False.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Proportion of the data to use as a validation set. Only used if
shuffle_split = True. Defaults to 0.2.</p></li>
<li><p><strong>fs</strong> (<em>float</em><em>, </em><em>optional</em>) – Sampling frequency, required only if inputs are not mne.Epochs</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optinal</em>) – whether to perform scaling to baseline. Defaults to False.</p></li>
<li><p><strong>scale_interval</strong> (<em>NoneType</em><em>, </em><em>tuple of ints</em><em> or </em><em>floats</em><em>,  </em><em>optinal</em>) – baseline definition. If None (default) scaling is
perfromed based on all timepoints of the epoch.
If tuple, than baseline is data[tuple[0] : tuple[1]].
Only used if scale == True.</p></li>
<li><p><strong>crop_baseline</strong> (<em>bool</em><em>, </em><em>optinal</em>) – whether to crop baseline specified by ‘scale_interval’
after scaling (defaults to False).</p></li>
<li><p><strong>decimate</strong> (<em>False</em><em>, </em><em>int</em><em>, </em><em>optional</em>) – whether to decimate the input data (defaults to False).</p></li>
<li><p><strong>bp_filter</strong> (<em>bool</em><em>, </em><em>tuple</em><em>, </em><em>optinal</em>) – band pass filter.</p></li>
<li><p><strong>picks</strong> (<em>ndarray of int</em><em>, </em><em>optional</em>) – Indices of channels to pick for processing, if None all channels
are used.</p></li>
<li><p><strong>task</strong> (<em>'classification'</em><em>, </em><em>optional</em>) – So far the only available task.</p></li>
<li><p><strong>array_keys</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary mapping {‘X’:’data_matrix’,’y’:’labels’},
where ‘data_matrix’ and ‘labels’ are names of the corresponding
variables if your input is paths to .mat or .npz files.
Defaults to {‘X’:’X’, ‘y’:’y’}</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to overwrite the metafile if it already exists at the
specified path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>meta</strong> – metadata associated with the processed dataset. Contains all the
information about the dataset required for further processing with
mneflow.
Whenever the function is called the copy of metadata is also saved to
savepath/meta.pkl so it can be restored at any time.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Pre-processing functions are implemented mostly for for convenience when
working with array inputs.  When working with mne.epochs the use of
the corresponding mne functions is preferrable.</p>
<p class="rubric">Examples</p>
<p>meta = mneflow.produce_tfrecords(input_paths, **import_opts)</p>
</dd></dl>

<dl class="function">
<dt id="mneflow.utils.scale_to_baseline">
<code class="descclassname">mneflow.utils.</code><code class="descname">scale_to_baseline</code><span class="sig-paren">(</span><em>X</em>, <em>baseline=None</em>, <em>crop_baseline=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mneflow.utils.scale_to_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform global scaling based on a specified baseline.</p>
<p>Subtracts the mean and divides by the standard deviation of the amplitude
of all channels during the baseline interval. If input contains 306
channels performs separate scaling for magnetometers and gradiometers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – data array with dimensions [n_epochs, n_channels, time].</p></li>
<li><p><strong>baseline</strong> (<em>tuple of int</em><em>, </em><em>None</em>) – baseline definition (in samples). If baseline == None the whole
epoch is used for scaling.</p></li>
<li><p><strong>crop_baseline</strong> (<em>bool</em>) – whether to crop the baseline after scaling is applied.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>X</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="changelog.html" class="btn btn-neutral float-right" title="History" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro.html" class="btn btn-neutral float-left" title="MNEflow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Ivan Zubarev

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>